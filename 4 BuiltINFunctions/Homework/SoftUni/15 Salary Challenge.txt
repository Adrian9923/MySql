TASK:Write a query that returns the following fields:

first_name

last_name

department_id

Return them for all employees who have salaries higher than the average for their respective departments.

Select only the first 10 rows.

Order the results by department_id as a first criterion and by employee_id as a second criterion.




SELECT
    e.`first_name`,
    e.`last_name`,
    e.`department_id`
FROM
    `employees` AS e
INNER JOIN
    (
        SELECT
            `department_id`,
            AVG(`salary`) AS 'avg_salary'
        FROM
            `employees`
        GROUP BY
            `department_id`
    ) AS d
ON
    e.`department_id` = d.`department_id`
WHERE
    e.`salary` > d.`avg_salary`
ORDER BY
    e.`department_id`,
    e.`employee_id`
LIMIT 10;