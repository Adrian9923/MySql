TASK: Write a query that selects the following fields:

continent_code

currency_code

currency_usage

Find all continents and their most used currency.

Filter out any currency that is used in only one country.

Sort the result by continent_code and currency_code.




SELECT c.continent_code, c.currency_code, c.currency_usage
FROM (
  SELECT continent_code, currency_code, COUNT(*) AS currency_usage
  FROM countries
  GROUP BY continent_code, currency_code
  HAVING COUNT(*) > 1
) c
JOIN (
  SELECT continent_code, MAX(currency_usage) AS max_usage
  FROM (
    SELECT continent_code, currency_code, COUNT(*) AS currency_usage
    FROM countries
    GROUP BY continent_code, currency_code
  ) t
  GROUP BY continent_code
) m ON c.continent_code = m.continent_code AND c.currency_usage = m.max_usage
ORDER BY c.continent_code, c.currency_code;